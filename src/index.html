<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>MeOS</title>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/fix-scrollbar.css">
    <link rel="stylesheet" href="/css/desktop.css">
    <link rel="stylesheet" href="/css/taskbar.css">

    <!-- MODULES -->
    <script src="/modules/share.js"></script>


    <!-- COMPONENTS -->

    <!-- windows -->
    <script src="/components/windows.js" type="module"></script>
    <link rel="stylesheet" href="/css/window-defaults.css">
    
    <!-- notifications -->
    <script src="/components/notifications.js" type="module"></script>
    <link rel="stylesheet" href="/css/push-notifications.css">
    <script src="/js/notifications.js"></script>

    <!-- calendar widget -->
    <script src="/components/calendar.js" type="module"></script>

    <!-- taskbar apps -->
    <script src="/components/taskbar-app.js" type="module"></script>
    <script src="/js/taskbar-apps.js"></script>

    
    <!-- SCRIPTS -->
    <script src="/js/weather.js"></script>
    <script src="/js/connection.js"></script>
    <script src="/js/sound.js"></script>
    <script src="/js/taskbar.js"></script><!-- TASKBAR TIME -->
    <script src="/js/battery.js"></script>
    <link rel="stylesheet" href="/css/action-menu.css">
    <script src="/js/action-menu.js"></script>
    <script src="/js/welcome.js"></script>
    <script src="/js/context-menu.js"></script>
    <link rel="stylesheet" href="/css/context-menu.css">


    <!-- PWA -->
    <script src="/pwa/register.js"></script>

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#191919">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
</head>
<body>
    <div id="context-menu">
        <div class="vertical-section">
            <button onclick="window.history.back();">
                <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M11.62 3.81 7.43 8l4.19 4.19-1.53 1.52L4.38 8l5.71-5.71 1.53 1.52z"/></svg>
            </button>
            <button onclick="window.history.forward();">
                <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.38 12.19 8.57 8 4.38 3.81l1.53-1.52L11.62 8l-5.71 5.71-1.53-1.52z"/></svg>
            </button>
            <button onclick="window.location.reload();">
                <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><script xmlns=""/><path d="m500.33 0h-47.41a12 12 0 0 0 -12 12.57l4 82.76a247.42 247.42 0 0 0 -188.92-87.33c-136.66 0-248.1 111.53-248 248.19.1 136.88 111.1 247.81 248 247.81a247.1 247.1 0 0 0 166.18-63.91 12 12 0 0 0 .48-17.43l-34-34a12 12 0 0 0 -16.38-.55 176 176 0 1 1 29.82-230.31l-101.53-4.87a12 12 0 0 0 -12.57 12v47.41a12 12 0 0 0 12 12h200.33a12 12 0 0 0 12-12v-200.34a12 12 0 0 0 -12-12z"/></svg>
            </button>
            <button onclick="window.location.href='/about/';">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25"><path d="M23 9.99V22a2.006 2.006 0 0 1-2 2h-6v-8h-5v8H4a2.006 2.006 0 0 1-2-2V9.99a1.999 1.999 0 0 1 .79-1.59L12.5 1l9.71 7.4A1.999 1.999 0 0 1 23 9.99z"/></svg>
            </button>
        </div>
        <div class="separator"></div>
        <button onclick="document.documentElement.requestFullscreen();">
            <svg aria-hidden="true" style="stroke: var(--icon-fill);" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15" stroke-linecap="round" stroke-linejoin="round"></path></svg>
            Full Screen
        </button>
        <button onclick="document.exitFullscreen();">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 13H5a1 1 0 0 0 0 2h2.586l-5.293 5.293a1 1 0 0 0 1.414 1.414L9 16.414V19a1 1 0 0 0 2 0v-5a1 1 0 0 0-1-1zM16.414 15H19a1 1 0 0 0 0-2h-5a1 1 0 0 0-1 1v5a1 1 0 0 0 2 0v-2.586l5.293 5.293a1 1 0 0 0 1.414-1.414zM10 4a1 1 0 0 0-1 1v2.586L3.707 2.293a1 1 0 0 0-1.414 1.414L7.586 9H5a1 1 0 0 0 0 2h5a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1zM14 11h5a1 1 0 0 0 0-2h-2.586l5.293-5.293a1 1 0 1 0-1.414-1.414L15 7.586V5a1 1 0 0 0-2 0v5a1 1 0 0 0 1 1z"/></svg>
            Minimize
        </button>
    </div>

    <!-- Desktop -->
    <div id="desktop">
        <h1>MeOS</h1>
        <app-window name="About" class="website">
            <iframe src="/about/" frameborder="0"></iframe>
        </app-window>
        <div id="push-notifications">
            <!-- Notifications will be added here -->
        </div>
        <div id="action-menu">
            <div class="notifications scrollbar-slim">
                <header>
                    <h3>Notifications</h3>
                    <button class="clear-all">Clear all</button>
                </header>
                <div class="list">
                    <!-- Notifications will be added here -->
                </div>
            </div>
            <calendar-widget class="calendar"></calendar-widget>
        </div>
    </div>

    <!-- Taskbar -->
    <div id="taskbar">
        <section class="weather" title="20°C Cloudy">
            <!-- WEATHER -->
            <img class="weather" src="/assets/weather/sunny-day.svg" alt="weather">
            <div class="text">
                <h2 class="temp">20°C</h2>
                <p class="desc">Cloudy</p>
            </div>
        </section>

        <section class="apps" style="width: 60vw;">
            <!-- APPS -->
            <taskbar-app name="About" icon="/assets/apps/about.svg" class="open" onclick="openApp(this); window.open('/about/')"></taskbar-app>
            <taskbar-app name="Share" icon="/modules/share-white.svg" onclick="openApp(this); 
            const clipboard = function(element) {
                console.log(element);
                element.setAttribute('icon', '/modules/copy-white.svg');
                setTimeout(() => {
                    element.setAttribute('icon', '/modules/share-white.svg');
                }, 1000);
            };
            share(clipboard(this), undefined, undefined, description = 'Check out MeOS!');"></taskbar-app>
        </section>

        <section class="menu">
            <!-- MENU -->
            <div class="internet-access icon"
                title="Winternet&#013No connection"
                online-title="WiFi-Name&#013Internet access"
                offline-title="No internet access&#013No connections available"
                >
                <!-- 
                    title = default,
                    online-title = when connected,
                    offline-title = when not connected
                -->


                <img alt="Wifi"
                    src="/assets/connection/wifi.svg"
                    src-yes="/assets/connection/wifi.svg"
                    src-no="/assets/connection/no-wifi.svg"
                >
                <!-- src = default,
                     src-yes = when connected,
                     src-no = when not connected
                -->
            </div>

            <div class="speaker icon" title="Speakers (RTalk(L) Audio): 0%"><img
                alt="speaker"
                src="/assets/sound/speaker.svg"
                src-no="/assets/sound/speaker-muted.svg"
                src-1="/assets/sound/speaker-1.svg"
                src-2="/assets/sound/speaker-2.svg"
                src-3="/assets/sound/speaker-3.svg"
                speaker-levels="3">
                <!-- if the number of src-n values are changed, the `speaker-levels` attribute must be changed
                     each src-n value is a different volume level -> currently 3 levels
                 -->
            </div>
            
            <div class="battery icon" title="Battery status: 50% remaining">
                <img src="/assets/power/battery.svg" alt="battery">
            </div>
        </section>

        <section class="time" title="Tuesday, 30. January 2024">
            <!-- DISPLAY TIME -->
            <div class="time">14:51</div>
            <div class="date">30/01/2024</div>
            <!-- Would you like to know why I chose 14:51 on January 30, 2024? -->
            <!-- I chose this time and date because it was the exact time I started the WebOS project. -->
        </section>
    </div>

    <script>
        function checkLoadEventEnd() {
            if (performance.timing.loadEventEnd !== 0) {
                calculatePageLoadTime();
            } else {
                setTimeout(checkLoadEventEnd, 100);
            }
        }

        function calculatePageLoadTime() {
            // calculate console.log color based on value and thresholds
            function calculateColor(value, middle, max) {
                if (value < middle) {
                    return `green`;
                } else if (value >= middle && value < max) {
                    return `orange`;
                } else {
                    return `red`;
                }
            }

            const page_load_time = performance.timing.loadEventEnd - performance.timing.fetchStart;
            const dcl = performance.timing.domComplete - performance.timing.domInteractive;

            console.info(`%c[PERFORMANCE]%c Page load time is %c${page_load_time}%c ms`, "color: orange", "color: inherit", `color: ${calculateColor(page_load_time, 1000, 3000)};`, "color: inherit;");
            console.info(`%c[PERFORMANCE]%c DOM Content Loaded (DCL): %c${dcl}%c ms`, "color: orange", "color: inherit", `color: ${calculateColor(dcl, 800, 1200)};`, "color: inherit;");
        }

        window.addEventListener("load", checkLoadEventEnd, false);
    </script>
</body>
</html>